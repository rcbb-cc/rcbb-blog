<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>SpringBoot使用logback日志框架超详细教程 | 日常bb</title>
    <meta name="generator" content="VuePress 1.9.5">
    <link rel="icon" href="/img/favicon.ico">
    <script data-ad-client="ca-pub-8621788234752924" async="true" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-8621788234752924" crossorigin="anonymous"></script>
    <meta name="description" content="一些技术，一些随想，一些资源收藏。">
    <meta name="keywords" content="后端技术,rcbb,个人博客">
    <meta name="baidu-site-verification" content="7F55weZDDc">
    <meta name="theme-color" content="#7b074b">
    
    <link rel="preload" href="/assets/css/0.styles.d40c2a0a.css" as="style"><link rel="preload" href="/assets/js/app.f183bd5e.js" as="script"><link rel="preload" href="/assets/js/2.ae7bab8c.js" as="script"><link rel="preload" href="/assets/js/31.18d6e525.js" as="script"><link rel="prefetch" href="/assets/js/10.d53102f6.js"><link rel="prefetch" href="/assets/js/11.646febf5.js"><link rel="prefetch" href="/assets/js/12.81887ce3.js"><link rel="prefetch" href="/assets/js/13.621637c0.js"><link rel="prefetch" href="/assets/js/14.0150f885.js"><link rel="prefetch" href="/assets/js/15.7f18f496.js"><link rel="prefetch" href="/assets/js/16.69fb7a46.js"><link rel="prefetch" href="/assets/js/17.4dfbd4bc.js"><link rel="prefetch" href="/assets/js/18.61b5564d.js"><link rel="prefetch" href="/assets/js/19.0ee58fc9.js"><link rel="prefetch" href="/assets/js/20.487616f8.js"><link rel="prefetch" href="/assets/js/21.90e70f27.js"><link rel="prefetch" href="/assets/js/22.d6b983de.js"><link rel="prefetch" href="/assets/js/23.cc82aeb0.js"><link rel="prefetch" href="/assets/js/24.7ac2bb62.js"><link rel="prefetch" href="/assets/js/25.d13a82d3.js"><link rel="prefetch" href="/assets/js/26.e45f9ab4.js"><link rel="prefetch" href="/assets/js/27.1740771b.js"><link rel="prefetch" href="/assets/js/28.4a9f641c.js"><link rel="prefetch" href="/assets/js/29.677e0d93.js"><link rel="prefetch" href="/assets/js/3.396601ce.js"><link rel="prefetch" href="/assets/js/30.b260e854.js"><link rel="prefetch" href="/assets/js/32.6ee41b9e.js"><link rel="prefetch" href="/assets/js/33.89a8e1fd.js"><link rel="prefetch" href="/assets/js/34.3397a4d5.js"><link rel="prefetch" href="/assets/js/35.2a92ff28.js"><link rel="prefetch" href="/assets/js/36.23517e3e.js"><link rel="prefetch" href="/assets/js/37.9b7ffa67.js"><link rel="prefetch" href="/assets/js/38.6312ab8f.js"><link rel="prefetch" href="/assets/js/39.6cb32187.js"><link rel="prefetch" href="/assets/js/4.910dd52c.js"><link rel="prefetch" href="/assets/js/40.6f4d84a4.js"><link rel="prefetch" href="/assets/js/41.c1153c1c.js"><link rel="prefetch" href="/assets/js/42.f49d51d4.js"><link rel="prefetch" href="/assets/js/43.0ca861fd.js"><link rel="prefetch" href="/assets/js/44.9f5da1c3.js"><link rel="prefetch" href="/assets/js/45.75034ebd.js"><link rel="prefetch" href="/assets/js/46.9c872dd5.js"><link rel="prefetch" href="/assets/js/47.5f47c069.js"><link rel="prefetch" href="/assets/js/48.987beed0.js"><link rel="prefetch" href="/assets/js/49.a36c3d68.js"><link rel="prefetch" href="/assets/js/5.6de11f6c.js"><link rel="prefetch" href="/assets/js/50.5216ae3c.js"><link rel="prefetch" href="/assets/js/51.baa5293d.js"><link rel="prefetch" href="/assets/js/52.46ad157e.js"><link rel="prefetch" href="/assets/js/53.a9608afc.js"><link rel="prefetch" href="/assets/js/54.3615fe8a.js"><link rel="prefetch" href="/assets/js/55.dad36e14.js"><link rel="prefetch" href="/assets/js/56.83ff2c57.js"><link rel="prefetch" href="/assets/js/57.078795e4.js"><link rel="prefetch" href="/assets/js/58.bb3569c8.js"><link rel="prefetch" href="/assets/js/59.8743b223.js"><link rel="prefetch" href="/assets/js/6.df915fd0.js"><link rel="prefetch" href="/assets/js/60.dedae8eb.js"><link rel="prefetch" href="/assets/js/61.f64cb96f.js"><link rel="prefetch" href="/assets/js/7.f5cd3055.js"><link rel="prefetch" href="/assets/js/8.70d400ff.js"><link rel="prefetch" href="/assets/js/9.32d1a32c.js">
    <link rel="stylesheet" href="/assets/css/0.styles.d40c2a0a.css">
  </head>
  <body class="theme-mode-light">
    <div id="app" data-server-rendered="true"><div class="theme-container sidebar-open have-rightmenu"><header class="navbar blur"><div title="目录" class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/img/logo.png" alt="日常bb" class="logo"> <span class="site-name can-hide">日常bb</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><a href="/article/" class="nav-link">文章</a></div><div class="nav-item"><a href="/idea/" class="nav-link">冥思</a></div><div class="nav-item"><a href="/other/" class="nav-link">其他</a></div><div class="nav-item"><a href="/favorites/" class="nav-link">收藏</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="索引" class="dropdown-title"><a href="/archives/" class="link-title">索引</a> <span class="title" style="display:none;">索引</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/categories/" class="nav-link">分类</a></li><li class="dropdown-item"><!----> <a href="/tags/" class="nav-link">标签</a></li><li class="dropdown-item"><!----> <a href="/archives/" class="nav-link">归档</a></li></ul></div></div> <a href="https://github.com/rcbb-cc" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar-hover-trigger"></div> <aside class="sidebar" style="display:none;"><div class="blogger"><img src="https://rcbb-public.oss-cn-guangzhou.aliyuncs.com/avatar.jpg"> <div class="blogger-info"><h3>日常bb</h3> <span>想起来全是问题，做起来才有答案。</span></div></div> <nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><a href="/article/" class="nav-link">文章</a></div><div class="nav-item"><a href="/idea/" class="nav-link">冥思</a></div><div class="nav-item"><a href="/other/" class="nav-link">其他</a></div><div class="nav-item"><a href="/favorites/" class="nav-link">收藏</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="索引" class="dropdown-title"><a href="/archives/" class="link-title">索引</a> <span class="title" style="display:none;">索引</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/categories/" class="nav-link">分类</a></li><li class="dropdown-item"><!----> <a href="/tags/" class="nav-link">标签</a></li><li class="dropdown-item"><!----> <a href="/archives/" class="nav-link">归档</a></li></ul></div></div> <a href="https://github.com/rcbb-cc" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Java</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Redis</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>Spring</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>基础使用</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>Spring Security</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading open"><span>收藏</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/pages/9dc988/" aria-current="page" class="active sidebar-link">SpringBoot使用logback日志框架超详细教程</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level2"><a href="/pages/9dc988/#前言" class="sidebar-link">前言</a></li><li class="sidebar-sub-header level2"><a href="/pages/9dc988/#为什么使用logback" class="sidebar-link">为什么使用logback</a></li><li class="sidebar-sub-header level2"><a href="/pages/9dc988/#开始使用" class="sidebar-link">开始使用</a></li><li class="sidebar-sub-header level2"><a href="/pages/9dc988/#一、添加依赖" class="sidebar-link">一、添加依赖</a></li><li class="sidebar-sub-header level2"><a href="/pages/9dc988/#二、默认配置" class="sidebar-link">二、默认配置</a></li><li class="sidebar-sub-header level2"><a href="/pages/9dc988/#三、logback-spring-xml详解" class="sidebar-link">三、logback-spring.xml详解</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/pages/9dc988/#_3-1、-configuration-元素" class="sidebar-link">3.1、&lt;configuration&gt;元素</a></li><li class="sidebar-sub-header level3"><a href="/pages/9dc988/#_3-2、-logger-元素" class="sidebar-link">3.2、&lt;logger&gt;元素</a></li><li class="sidebar-sub-header level3"><a href="/pages/9dc988/#_3-3、-root-元素" class="sidebar-link">3.3、&lt;root&gt;元素</a></li><li class="sidebar-sub-header level3"><a href="/pages/9dc988/#_3-4、-appender-元素" class="sidebar-link">3.4、&lt;appender&gt;元素</a></li><li class="sidebar-sub-header level4"><a href="/pages/9dc988/#_3-4-1、consoleappender" class="sidebar-link">3.4.1、ConsoleAppender</a></li><li class="sidebar-sub-header level4"><a href="/pages/9dc988/#_3-4-2、rollingfileappender" class="sidebar-link">3.4.2、RollingFileAppender</a></li><li class="sidebar-sub-header level4"><a href="/pages/9dc988/#_3-4-3、滚动策略" class="sidebar-link">3.4.3、滚动策略</a></li><li class="sidebar-sub-header level3"><a href="/pages/9dc988/#_3-5、-encoder-元素" class="sidebar-link">3.5、&lt;encoder&gt;元素</a></li><li class="sidebar-sub-header level3"><a href="/pages/9dc988/#_3-6、-filter-元素" class="sidebar-link">3.6、&lt;filter&gt;元素</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/pages/9dc988/#四、详细的logback-spring-xml示例" class="sidebar-link">四、详细的logback-spring.xml示例</a></li><li class="sidebar-sub-header level2"><a href="/pages/9dc988/#五、附加内容" class="sidebar-link">五、附加内容</a></li></ul></li></ul></section></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>工具</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>概念</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>容器</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>实战</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>AI</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>前端</span> <span class="arrow right"></span></p> <!----></section></li></ul> <div class="sidebar-slot sidebar-slot-bottom"><ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-8621788234752924"
     data-ad-slot="8498052873"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script></div></aside> <div><main class="page"><div class="theme-vdoing-wrapper "><div class="articleInfo-wrap" data-v-06225672><div class="articleInfo" data-v-06225672><ul class="breadcrumbs" data-v-06225672><li data-v-06225672><a href="/" title="首页" class="iconfont icon-home router-link-active" data-v-06225672></a></li> <li data-v-06225672><a href="/article/#文章" data-v-06225672>文章</a></li><li data-v-06225672><a href="/article/#Spring" data-v-06225672>Spring</a></li><li data-v-06225672><a href="/article/#收藏" data-v-06225672>收藏</a></li></ul> <div class="info" data-v-06225672><div title="作者" class="author iconfont icon-touxiang" data-v-06225672><a href="https://rcbb.cc/" target="_blank" title="作者" class="beLink" data-v-06225672>rcbb</a></div> <div title="创建时间" class="date iconfont icon-riqi" data-v-06225672><a href="javascript:;" data-v-06225672>2022-08-16</a></div> <!----></div></div></div> <!----> <div class="content-wrapper"><div class="right-menu-wrapper"><div class="right-menu-margin"><div class="right-menu-title">目录</div> <div class="right-menu-content"></div></div></div> <h1><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAABH1JREFUSA3tVl1oHFUUPmdmd2ltklqbpJDiNnXFmgbFktho7YMPNiJSSZM0+CAYSkUELVhM6YuwIPpgoOKDqOBDC0XE2CQoNtQXBUFTTcCi+Wlh1V2TQExsUzcltd3M9Tt3ZjZzZ2fT+OJTL8yeM+eee757fmeJbq//KQL8X3DUSFOcfr7cRsRtxNQMWueeVzOkaITIGqQHNg5y8+jNW9ldM7A6nTpAjuolUikAwq7CE3WcM2RRDz+XGVgN3FptU/aUSlvq9Pa3iZ1+sgAqJyyAFqkipd9dqiwHF3P65YycLWc/6sqGrvoEoIp6DOFaX5h6+dnfjkWprwqsPk0dUGq5vySwDImC10KxFHgGL1SWoc92O3eVht09qdXNH11I2SsTsJYqMWzihqGMi+A+Garf3BAuuLI5oGlULyNfyB/HYNujwktOfRrMr5t77NmevqaUopx0grnKAyvVpmwUDB4x6FPXuGvYLTDwWsejwgtgkYKPqRJg8SV6xaiZ3ZTppGneS4yfH5/66fZSDHv+QZci/+h5c5UHtpy67JUqGppM0sh0Nc1dW6/N1W5Yoqat8/TU/VnadmdeW2PLLSyh0cvxBs3KbqTmwYPpxN4do/mzE8nEpvX/UMu2Wbp74zUAK5q6WkHns7V0eWkdPbPzd3rxkTGybadYySumVzhcaJFbs5UrEkQ/+CK8gF5dnh/6ciIZ73gwQ927L1IitoxKLXYP3SjYdOrHHfTZhRRlFyrorafPk20B3HPD1y2G3qKZME5Jcf3t/HUC13/8tSd++vqFveMUTwAUxSUFI1QekR1+bIze3D9MF2aq6cPvG72CgnldWCFqyRw3lwH8ZMerjTD9ElRO7Gv44wNpC90aASqGfVlz/Rx17srQ57/UU26hkhQqUB7dBR71WmzQhHUnblGmVOEw0jhbV1n9OlXUDCIRGaNV5Jp43N516fN7JmnTHdfp7Hgy0luO4aMhtkLL8Bi3bUWYvzh5Mn1dTxrL6QmGuRhGL/TiTTxRoEdTszSaq9GR0NGA3KdkOz3hqSV3MIDhQ5IVX/Ivx3umBti2es2h4eZby7x8br1rkf7Mo90AqC8aQ3sJeNzqFRu+vSANAQe3PL7l0HGOAdwDCeZYvNKeoZp1Qfs6Aipndh86HmFRi0LAnEO47wsqM6cdfjh3jBPUzhZy7nvlUfFsamED1VQt6aISHVymXZ/B2aCtIG8AI8xfobj2d3en1wWVhOeHELKmLQ1s211s88comkv4UCwWyF787mJdYXtNfhKAXVqnKTq8QZvGAGGOfaTo5pGZ/PwbUCr5+DPr/1J92JNHr9aOl/F3iI5+O1nfybsGxoimvZ3ViWSluDITw3P37mypheDIPY0tw7+O/5ApbkYw+zpfaUVu32Pi98+defdUhEpZkRFq0aqyNh9FuL9hpYbEm6iwi0z2REd09ZmyENEbuhjDWzKvZXTqKYaBIr3tt5kuPtQBZFvEUwHt60vfCNu41XsksH9Ij1BMMz1Y0OOunHNShFIP5868g5zeXmuLwL9T4b6Q2+KejgAAAABJRU5ErkJggg==">SpringBoot使用logback日志框架超详细教程<!----></h1>  <div class="theme-vdoing-content content__default"><h2 id="前言"><a href="#前言" class="header-anchor">#</a> 前言</h2> <p>项目中日志系统是必不可少的，目前比较流行的日志框架有 log4j、logback 等，可能大家还不知道，这两个框架的作者是同一个人，Logback 旨在作为流行的 log4j 项目的后续版本，从而恢复 log4j 离开的位置。</p> <p>另外 slf4j(Simple Logging Facade for Java) 则是一个日志门面框架，提供了日志系统中常用的接口，logback 和 log4j 则对slf4j 进行了实现。</p> <p>我们本文将讲述如何在 SpringBoot 中应用 logback+slf4j 实现日志的记录。</p> <h2 id="为什么使用logback"><a href="#为什么使用logback" class="header-anchor">#</a> 为什么使用logback</h2> <ul><li>Logback 是log4j 框架的作者开发的新一代日志框架，它效率更高、能够适应诸多的运行环境，同时天然支持 SLF4J。</li> <li>Logback 的定制性更加灵活，同时也是 SpringBoot 的内置日志框架。</li></ul> <h2 id="开始使用"><a href="#开始使用" class="header-anchor">#</a> 开始使用</h2> <h2 id="一、添加依赖"><a href="#一、添加依赖" class="header-anchor">#</a> 一、添加依赖</h2> <p>实际开发中我们直接引入<code>spring-boot-starter-web</code>依赖即可，因为<code>spring-boot-starter-web</code>包含了<code>spring-boot-starter</code>。<br>
而<code>spring-boot-starter</code>包含了<code>spring-boot-starter-logging</code>，所以我们只需要引入 web 组件即可。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>&lt;dependency&gt;
    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
    &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;
&lt;/dependency&gt;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h2 id="二、默认配置"><a href="#二、默认配置" class="header-anchor">#</a> 二、默认配置</h2> <p>默认情况下 SpringBoot 将日志输出到控制台，不会写到日志文件。</p> <p>如果要编写除控制台输出之外的日志文件，则需在 application.properties 中设置 logging.file 或 logging.path 属性。<br>
注：二者不能同时使用，如若同时使用，则只有 logging.file 生效。</p> <ul><li><p>logging.file=文件名（设置文件，可以是绝对路径，也可以是相对路径。例：logging.file=my.log）</p></li> <li><p>logging.path=日志文件路径（设置目录，会在该目录下创建spring.log文件，并写入日志内容。例：logging.path=/var/log）</p></li> <li><p>logging.level.包名=指定包下的日志级别</p></li> <li><p>logging.pattern.console=日志打印规则</p></li></ul> <p>可以看到这种方式配置简单，但是能实现的功能也非常有限，如果想要更复杂的需求，就需要下面的定制化配置了。</p> <h2 id="三、logback-spring-xml详解"><a href="#三、logback-spring-xml详解" class="header-anchor">#</a> 三、logback-spring.xml详解</h2> <p>SpringBoot 官方推荐优先使用带有<code>-spring</code>的文件名作为你的日志配置（如使用<code>logback-spring.xml</code>，而不是<code>logback.xml</code>），命名为<code>logback-spring.xml</code>的日志配置文件，将 xml 放至<code>src/main/resource</code>下面。</p> <p>也可以使用自定义的名称，比如<code>logback-config.xml</code>，只需要在 application.properties 文件中使用<code>logging.config=classpath:logback-config.xml</code>指定即可。</p> <p>在讲解 logback-spring.xml之前我们先来了解三个单词：</p> <ul><li>Logger（记录器）</li> <li>Appenders（附加器）</li> <li>Layouts（布局）</li></ul> <p>Logback 基于三个主要类：Logger，Appender和Layout。</p> <p>这三种类型的组件协同工作，使开发人员能够根据消息类型和级别记录消息，并在运行时控制这些消息的格式以及报告的位置。</p> <p>首先给出一个基本的 xml 配置如下：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>&lt;configuration&gt;
 
  &lt;appender name=&quot;STDOUT&quot; class=&quot;ch.qos.logback.core.ConsoleAppender&quot;&gt;
    &lt;!-- encoders are assigned the type
         ch.qos.logback.classic.encoder.PatternLayoutEncoder by default --&gt;
    &lt;encoder&gt;
      &lt;pattern&gt;%d{HH:mm:ss.SSS} [%thread] %-5level %logger{36} - %msg%n&lt;/pattern&gt;
    &lt;/encoder&gt;
  &lt;/appender&gt;
 
  &lt;logger name=&quot;chapters.configuration&quot; level=&quot;INFO&quot;/&gt;
 
  &lt;!-- Strictly speaking, the level attribute is not necessary since --&gt;
  &lt;!-- the level of the root level is set to DEBUG by default.       --&gt;
  &lt;root level=&quot;DEBUG&quot;&gt;          
    &lt;appender-ref ref=&quot;STDOUT&quot; /&gt;
  &lt;/root&gt;  
  
&lt;/configuration&gt;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><h3 id="_3-1、-configuration-元素"><a href="#_3-1、-configuration-元素" class="header-anchor">#</a> 3.1、<code>&lt;configuration&gt;</code>元素</h3> <p>logback.xml 配置文件的基本结构可以描述为<code>&lt;configuration&gt;</code>元素，包含零个或多个<code>&lt;appender&gt;</code>元素，后跟零个或多个<code>&lt;logger&gt;</code>元素，后跟最多一个<code>&lt;root&gt;</code>元素(也可以没有)。</p> <p>下图说明了这种基本结构：</p> <p><img src="https://rcbb-blog.oss-cn-guangzhou.aliyuncs.com/2022/08/20220816135959-14ab0e.png?x-oss-process=style/yuantu_shuiyin" alt="configuration元素"></p> <h3 id="_3-2、-logger-元素"><a href="#_3-2、-logger-元素" class="header-anchor">#</a> 3.2、<code>&lt;logger&gt;</code>元素</h3> <p><code>&lt;logger&gt;</code>元素只接受一个必需的 name 属性，一个可选的 level 属性和一个可选的 additivity 属性，允许值为 true 或 false 。</p> <p>level 属性的值允许一个不区分大小写的字符串值 TRACE，DEBUG，INFO，WARN，ERROR，ALL 或 OFF。</p> <p><code>&lt;logger&gt;</code>元素可以包含零个或多个<code>&lt;appender-ref&gt;</code>元素。</p> <p>这样引用的每个 appender 都被添加到指定的 logger 中，logger 元素级别具有继承性。</p> <p>例1：仅为根记录器分配了级别。此级别值 DEBUG 由其他记录器 X，X.Y和X.Y.Z 继承。</p> <p><img src="https://rcbb-blog.oss-cn-guangzhou.aliyuncs.com/2022/08/20220816140326-69a802.png?x-oss-process=style/yuantu_shuiyin" alt="继承性-例1"></p> <p>例2：所有记录器都有一个指定的级别值。级别继承不起作用。</p> <p><img src="https://rcbb-blog.oss-cn-guangzhou.aliyuncs.com/2022/08/20220816140424-2d88f7.png?x-oss-process=style/yuantu_shuiyin" alt="继承性-例2"></p> <p>例3：记录器 root，X 和 X.Y.Z 分别被分配了 DEBUG，INFO 和 ERROR 级别。Logger X.Y 从其父 X 继承其级别值。</p> <p><img src="https://rcbb-blog.oss-cn-guangzhou.aliyuncs.com/2022/08/20220816140547-5d34fc.png?x-oss-process=style/yuantu_shuiyin" alt="继承性-例3"></p> <p>例4：记录器 root 和 X 分别被分配了 DEBUG 和 INFO 级别。记录器 X.Y 和 X.Y.Z 从其最近的父 X 继承其级别值，该父级具有指定的级别。</p> <p><img src="https://rcbb-blog.oss-cn-guangzhou.aliyuncs.com/2022/08/20220816140710-ad2eee.png?x-oss-process=style/yuantu_shuiyin" alt="继承性-例4"></p> <h3 id="_3-3、-root-元素"><a href="#_3-3、-root-元素" class="header-anchor">#</a> 3.3、<code>&lt;root&gt;</code>元素</h3> <p><code>&lt;root&gt;</code>元素配置根记录器。<br>
它支持单个属性，即 level 属性。<br>
它不允许任何其他属性，因为 additivity 标志不适用于根记录器。<br>
此外，由于根记录器已被命名为 ROOT ，因此它也不允许使用 name 属性。</p> <p>level 属性的值可以是不区分大小写的字符串 TRACE，DEBUG，INFO，WARN，ERROR，ALL 或 OFF 之一。</p> <p><code>&lt;root&gt;</code>元素可以包含零个或多个<code>&lt;appender-ref&gt;</code>元素。</p> <p>这样引用的每个 appender 都被添加到根记录器中。</p> <h3 id="_3-4、-appender-元素"><a href="#_3-4、-appender-元素" class="header-anchor">#</a> 3.4、<code>&lt;appender&gt;</code>元素</h3> <p>appender 使用<code>&lt;appender&gt;</code>元素配置，该元素采用两个必需属性 name 和 class。<br>
name 属性指定 appender 的名称，而 class 属性指定要实例化的 appender 类的完全限定名称。</p> <p><code>&lt;appender&gt;</code>元素可以包含零个或一个<code>&lt;layout&gt;</code>元素，零个或多个<code>&lt;encoder&gt;</code>元素以及零个或多个<code>&lt;filter&gt;</code>元素。</p> <p>下图说明了常见的结构：</p> <p><img src="https://rcbb-blog.oss-cn-guangzhou.aliyuncs.com/2022/08/20220816141417-ab1605.png?x-oss-process=style/yuantu_shuiyin" alt="appender元素"></p> <p>重要：在 logback 中，输出目标称为 appender，addAppender 方法将 appender 添加到给定的记录器 logger。<br>
给定记录器的每个启用的日志记录请求都将转发到该记录器中的所有 appender 以及层次结构中较高的 appender。
换句话说，appender 是从记录器层次结构中附加地继承的。</p> <p>例如，如果将控制台 appender 添加到根记录器，则所有启用的日志记录请求将至少在控制台上打印。</p> <p>如果另外将文件追加器添加到记录器（例如L），则对 L 和 L 的子项启用的记录请求将打印在文件和控制台上。<br>
通过将记录器的 additivity 标志设置为 false，可以覆盖此默认行为，以便不再添加 appender 累积。</p> <p>Appender 是一个接口，它有许多子接口和实现类，具体如下图所示：</p> <p><img src="https://rcbb-blog.oss-cn-guangzhou.aliyuncs.com/2022/08/20220816143228-2ae38d.png?x-oss-process=style/yuantu_shuiyin" alt="Appender"></p> <p>其中最重要的两个Appender为：ConsoleAppender 、RollingFileAppender。</p> <h4 id="_3-4-1、consoleappender"><a href="#_3-4-1、consoleappender" class="header-anchor">#</a> 3.4.1、ConsoleAppender</h4> <p>ConsoleAppender，如名称所示，将日志输出到控制台上。</p> <h4 id="_3-4-2、rollingfileappender"><a href="#_3-4-2、rollingfileappender" class="header-anchor">#</a> 3.4.2、RollingFileAppender</h4> <p>RollingFileAppender，是 FileAppender 的一个子类，扩展了 FileAppender，具有翻转日志文件的功能。</p> <p>例如，RollingFileAppender 可以记录到名为 log.txt 文件的文件，并且一旦满足某个条件，就将其日志记录目标更改为另一个文件。</p> <p>有两个与 RollingFileAppender 交互的重要子组件。</p> <ul><li>RollingPolicy：负责执行翻转所需的操作。</li> <li>TriggeringPolicy：将确定是否以及何时发生翻转。</li></ul> <p>因此，RollingPolicy 负责什么和 TriggeringPolicy 负责什么时候。</p> <p>作为任何用途，RollingFileAppender 必须同时设置 RollingPolicy 和 TriggeringPolicy。<br>
但是，如果其 RollingPolicy 也实现了TriggeringPolicy 接口，则只需要显式指定前者。</p> <h4 id="_3-4-3、滚动策略"><a href="#_3-4-3、滚动策略" class="header-anchor">#</a> 3.4.3、滚动策略</h4> <p>TimeBasedRollingPolicy：可能是最受欢迎的滚动策略。它根据时间定义翻转策略，例如按天或按月。<br>
TimeBasedRollingPolicy 承担滚动和触发所述翻转的责任。实际上，TimeBasedTriggeringPolicy 实现了 RollingPolicy 和 TriggeringPolicy 接口。</p> <p>SizeAndTimeBasedRollingPolicy：有时您可能希望按日期归档文件，但同时限制每个日志文件的大小，特别是如果后处理工具对日志文件施加大小限制。<br>
为了满足此要求，logback 提供了 SizeAndTimeBasedRollingPolicy ，它是 TimeBasedRollingPolicy 的一个子类，实现了基于时间和日志文件大小的翻滚策略。</p> <h3 id="_3-5、-encoder-元素"><a href="#_3-5、-encoder-元素" class="header-anchor">#</a> 3.5、<code>&lt;encoder&gt;</code>元素</h3> <p>encoder 中最重要就是 pattern 属性，它负责控制输出日志的格式，这里给出一个我自己写的示例：</p> <blockquote><p><pattern>%d{yyyy-MM-dd HH:mm:ss.SSS} %highlight(%-5level) --- [%15.15(%thread)] %cyan(%-40.40(%logger{40})) : %msg%n</pattern></p></blockquote> <p><img src="https://rcbb-blog.oss-cn-guangzhou.aliyuncs.com/2022/08/20220816143827-d6b5b2.png?x-oss-process=style/yuantu_shuiyin" alt="输出格式"></p> <div class="language- line-numbers-mode"><pre class="language-text"><code>%d{yyyy-MM-dd HH:mm:ss.SSS}：日期
%-5level：日志级别
%highlight()：颜色，info为蓝色，warn为浅红，error为加粗红，debug为黑色
%thread：打印日志的线程
%15.15():如果记录的线程字符长度小于15(第一个)则用空格在左侧补齐,如果字符长度大于15(第二个),则从开头开始截断多余的字符 
%logger：日志输出的类名
%-40.40()：如果记录的logger字符长度小于40(第一个)则用空格在右侧补齐,如果字符长度大于40(第二个),则从开头开始截断多余的字符
%cyan：颜色
%msg：日志输出内容
%n：换行符
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h3 id="_3-6、-filter-元素"><a href="#_3-6、-filter-元素" class="header-anchor">#</a> 3.6、<code>&lt;filter&gt;</code>元素</h3> <p>filter 中最重要的两个过滤器为：LevelFilter、ThresholdFilter。</p> <p>LevelFilter 根据精确的级别匹配过滤事件。<br>
如果事件的级别等于配置的级别，则筛选器接受或拒绝该事件，具体取决于 onMatch 和 onMismatch 属性的配置。</p> <p>例如下面配置将只打印 INFO 级别的日志，其余的全部禁止打印输出：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>&lt;configuration&gt;
  &lt;appender name=&quot;CONSOLE&quot; class=&quot;ch.qos.logback.core.ConsoleAppender&quot;&gt;
    &lt;filter class=&quot;ch.qos.logback.classic.filter.LevelFilter&quot;&gt;
      &lt;level&gt;INFO&lt;/level&gt;
      &lt;onMatch&gt;ACCEPT&lt;/onMatch&gt;
      &lt;onMismatch&gt;DENY&lt;/onMismatch&gt;
    &lt;/filter&gt;
    &lt;encoder&gt;
      &lt;pattern&gt;
        %-4relative [%thread] %-5level %logger{30} - %msg%n
      &lt;/pattern&gt;
    &lt;/encoder&gt;
  &lt;/appender&gt;
  &lt;root level=&quot;DEBUG&quot;&gt;
    &lt;appender-ref ref=&quot;CONSOLE&quot; /&gt;
  &lt;/root&gt;
&lt;/configuration&gt;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><p>ThresholdFilter 过滤低于指定阈值的事件。<br>
对于等于或高于阈值的事件，ThresholdFilter 将在调用其 decision方法时响应 NEUTRAL。</p> <p>但是，将拒绝级别低于阈值的事件，例如下面的配置将拒绝所有低于 INFO 级别的日志，只输出 INFO 以及以上级别的日志：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>&lt;configuration&gt;
  &lt;appender name=&quot;CONSOLE&quot;
    class=&quot;ch.qos.logback.core.ConsoleAppender&quot;&gt;
    &lt;!-- deny all events with a level below INFO, that is TRACE and DEBUG --&gt;
    &lt;filter class=&quot;ch.qos.logback.classic.filter.ThresholdFilter&quot;&gt;
      &lt;level&gt;INFO&lt;/level&gt;
    &lt;/filter&gt;
    &lt;encoder&gt;
      &lt;pattern&gt;
        %-4relative [%thread] %-5level %logger{30} - %msg%n
      &lt;/pattern&gt;
    &lt;/encoder&gt;
  &lt;/appender&gt;
  &lt;root level=&quot;DEBUG&quot;&gt;
    &lt;appender-ref ref=&quot;CONSOLE&quot; /&gt;
  &lt;/root&gt;
&lt;/configuration&gt;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><h2 id="四、详细的logback-spring-xml示例"><a href="#四、详细的logback-spring-xml示例" class="header-anchor">#</a> 四、详细的logback-spring.xml示例</h2> <p>以上介绍了 xml 中重要的几个元素，下面将我配置的 xml 贴出来以供参考（实现了基于日期和大小翻滚的策略，以及经 INFO 和 ERROR 日志区分输出，还有规范日志输出格式等）</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;configuration debug=&quot;true&quot;&gt;
 
    &lt;!-- appender是configuration的子节点，是负责写日志的组件。 --&gt;
    &lt;!-- ConsoleAppender：把日志输出到控制台 --&gt;
    &lt;appender name=&quot;STDOUT&quot; class=&quot;ch.qos.logback.core.ConsoleAppender&quot;&gt;
        &lt;!-- 默认情况下，每个日志事件都会立即刷新到基础输出流。 这种默认方法更安全，因为如果应用程序在没有正确关闭appender的情况下退出，则日志事件不会丢失。
         但是，为了显着增加日志记录吞吐量，您可能希望将immediateFlush属性设置为false --&gt;
        &lt;!--&lt;immediateFlush&gt;true&lt;/immediateFlush&gt;--&gt;
        &lt;encoder&gt;
            &lt;!-- %37():如果字符没有37个字符长度,则左侧用空格补齐 --&gt;
            &lt;!-- %-37():如果字符没有37个字符长度,则右侧用空格补齐 --&gt;
            &lt;!-- %15.15():如果记录的线程字符长度小于15(第一个)则用空格在左侧补齐,如果字符长度大于15(第二个),则从开头开始截断多余的字符 --&gt;
            &lt;!-- %-40.40():如果记录的logger字符长度小于40(第一个)则用空格在右侧补齐,如果字符长度大于40(第二个),则从开头开始截断多余的字符 --&gt;
            &lt;!-- %msg：日志打印详情 --&gt;
            &lt;!-- %n:换行符 --&gt;
            &lt;!-- %highlight():转换说明符以粗体红色显示其级别为ERROR的事件，红色为WARN，BLUE为INFO，以及其他级别的默认颜色。 --&gt;
            &lt;pattern&gt;%d{yyyy-MM-dd HH:mm:ss.SSS} %highlight(%-5level) --- [%15.15(%thread)] %cyan(%-40.40(%logger{40})) : %msg%n&lt;/pattern&gt;
            &lt;!-- 控制台也要使用UTF-8，不要使用GBK，否则会中文乱码 --&gt;
            &lt;charset&gt;UTF-8&lt;/charset&gt;
        &lt;/encoder&gt;
    &lt;/appender&gt;
 
    &lt;!-- info 日志--&gt;
    &lt;!-- RollingFileAppender：滚动记录文件，先将日志记录到指定文件，当符合某个条件时，将日志记录到其他文件 --&gt;
    &lt;!-- 以下的大概意思是：1.先按日期存日志，日期变了，将前一天的日志文件名重命名为XXX%日期%索引，新的日志仍然是project_info.log --&gt;
    &lt;!--             2.如果日期没有发生变化，但是当前日志的文件大小超过10MB时，对当前日志进行分割 重命名--&gt;
    &lt;appender name=&quot;info_log&quot; class=&quot;ch.qos.logback.core.rolling.RollingFileAppender&quot;&gt;
        &lt;!--日志文件路径和名称--&gt;
        &lt;File&gt;logs/project_info.log&lt;/File&gt;
        &lt;!--是否追加到文件末尾,默认为true--&gt;
        &lt;append&gt;true&lt;/append&gt;
        &lt;filter class=&quot;ch.qos.logback.classic.filter.LevelFilter&quot;&gt;
            &lt;level&gt;ERROR&lt;/level&gt;
            &lt;onMatch&gt;DENY&lt;/onMatch&gt;&lt;!-- 如果命中ERROR就禁止这条日志 --&gt;
            &lt;onMismatch&gt;ACCEPT&lt;/onMismatch&gt;&lt;!-- 如果没有命中就使用这条规则 --&gt;
        &lt;/filter&gt;
        &lt;!--有两个与RollingFileAppender交互的重要子组件。 第一个RollingFileAppender子组件，即RollingPolicy:负责执行翻转所需的操作。
         RollingFileAppender的第二个子组件，即TriggeringPolicy:将确定是否以及何时发生翻转。 因此，RollingPolicy负责什么和TriggeringPolicy负责什么时候.
        作为任何用途，RollingFileAppender必须同时设置RollingPolicy和TriggeringPolicy,但是，如果其RollingPolicy也实现了TriggeringPolicy接口，则只需要显式指定前者。--&gt;
        &lt;rollingPolicy class=&quot;ch.qos.logback.core.rolling.SizeAndTimeBasedRollingPolicy&quot;&gt;
            &lt;!-- 日志文件的名字会根据fileNamePattern的值，每隔一段时间改变一次 --&gt;
            &lt;!-- 文件名：logs/project_info.2017-12-05.0.log --&gt;
            &lt;!-- 注意：SizeAndTimeBasedRollingPolicy中 ％i和％d令牌都是强制性的，必须存在，要不会报错 --&gt;
            &lt;fileNamePattern&gt;logs/project_info.%d.%i.log&lt;/fileNamePattern&gt;
            &lt;!-- 每产生一个日志文件，该日志文件的保存期限为30天, ps:maxHistory的单位是根据fileNamePattern中的翻转策略自动推算出来的,例如上面选用了yyyy-MM-dd,则单位为天
            如果上面选用了yyyy-MM,则单位为月,另外上面的单位默认为yyyy-MM-dd--&gt;
            &lt;maxHistory&gt;30&lt;/maxHistory&gt;
            &lt;!-- 每个日志文件到10mb的时候开始切分，最多保留30天，但最大到20GB，哪怕没到30天也要删除多余的日志 --&gt;
            &lt;totalSizeCap&gt;20GB&lt;/totalSizeCap&gt;
            &lt;!-- maxFileSize:这是活动文件的大小，默认值是10MB，测试时可改成5KB看效果 --&gt;
            &lt;maxFileSize&gt;10MB&lt;/maxFileSize&gt;
        &lt;/rollingPolicy&gt;
        &lt;!--编码器--&gt;
        &lt;encoder&gt;
            &lt;!-- pattern节点，用来设置日志的输入格式 ps:日志文件中没有设置颜色,否则颜色部分会有ESC[0:39em等乱码--&gt;
            &lt;pattern&gt;%d{yyyy-MM-dd HH:mm:ss.SSS} %-5level --- [%15.15(%thread)] %-40.40(%logger{40}) : %msg%n&lt;/pattern&gt;
            &lt;!-- 记录日志的编码:此处设置字符集 - --&gt;
            &lt;charset&gt;UTF-8&lt;/charset&gt;
        &lt;/encoder&gt;
    &lt;/appender&gt;
 
    &lt;!-- error 日志--&gt;
    &lt;!-- RollingFileAppender：滚动记录文件，先将日志记录到指定文件，当符合某个条件时，将日志记录到其他文件 --&gt;
    &lt;!-- 以下的大概意思是：1.先按日期存日志，日期变了，将前一天的日志文件名重命名为XXX%日期%索引，新的日志仍然是project_error.log --&gt;
    &lt;!--             2.如果日期没有发生变化，但是当前日志的文件大小超过10MB时，对当前日志进行分割 重命名--&gt;
    &lt;appender name=&quot;error_log&quot; class=&quot;ch.qos.logback.core.rolling.RollingFileAppender&quot;&gt;
        &lt;!--日志文件路径和名称--&gt;
        &lt;File&gt;logs/project_error.log&lt;/File&gt;
        &lt;!--是否追加到文件末尾,默认为true--&gt;
        &lt;append&gt;true&lt;/append&gt;
        &lt;!-- ThresholdFilter过滤低于指定阈值的事件。 对于等于或高于阈值的事件，ThresholdFilter将在调用其decision（）方法时响应NEUTRAL。 但是，将拒绝级别低于阈值的事件 --&gt;
        &lt;filter class=&quot;ch.qos.logback.classic.filter.ThresholdFilter&quot;&gt;
            &lt;level&gt;ERROR&lt;/level&gt;&lt;!-- 低于ERROR级别的日志（debug,info）将被拒绝，等于或者高于ERROR的级别将相应NEUTRAL --&gt;
        &lt;/filter&gt;
        &lt;!--有两个与RollingFileAppender交互的重要子组件。 第一个RollingFileAppender子组件，即RollingPolicy:负责执行翻转所需的操作。
        RollingFileAppender的第二个子组件，即TriggeringPolicy:将确定是否以及何时发生翻转。 因此，RollingPolicy负责什么和TriggeringPolicy负责什么时候.
       作为任何用途，RollingFileAppender必须同时设置RollingPolicy和TriggeringPolicy,但是，如果其RollingPolicy也实现了TriggeringPolicy接口，则只需要显式指定前者。--&gt;
        &lt;rollingPolicy class=&quot;ch.qos.logback.core.rolling.SizeAndTimeBasedRollingPolicy&quot;&gt;
            &lt;!-- 活动文件的名字会根据fileNamePattern的值，每隔一段时间改变一次 --&gt;
            &lt;!-- 文件名：logs/project_error.2017-12-05.0.log --&gt;
            &lt;!-- 注意：SizeAndTimeBasedRollingPolicy中 ％i和％d令牌都是强制性的，必须存在，要不会报错 --&gt;
            &lt;fileNamePattern&gt;logs/project_error.%d.%i.log&lt;/fileNamePattern&gt;
            &lt;!-- 每产生一个日志文件，该日志文件的保存期限为30天, ps:maxHistory的单位是根据fileNamePattern中的翻转策略自动推算出来的,例如上面选用了yyyy-MM-dd,则单位为天
            如果上面选用了yyyy-MM,则单位为月,另外上面的单位默认为yyyy-MM-dd--&gt;
            &lt;maxHistory&gt;30&lt;/maxHistory&gt;
            &lt;!-- 每个日志文件到10mb的时候开始切分，最多保留30天，但最大到20GB，哪怕没到30天也要删除多余的日志 --&gt;
            &lt;totalSizeCap&gt;20GB&lt;/totalSizeCap&gt;
            &lt;!-- maxFileSize:这是活动文件的大小，默认值是10MB，测试时可改成5KB看效果 --&gt;
            &lt;maxFileSize&gt;10MB&lt;/maxFileSize&gt;
        &lt;/rollingPolicy&gt;
        &lt;!--编码器--&gt;
        &lt;encoder&gt;
            &lt;!-- pattern节点，用来设置日志的输入格式 ps:日志文件中没有设置颜色,否则颜色部分会有ESC[0:39em等乱码--&gt;
            &lt;pattern&gt;%d{yyyy-MM-dd HH:mm:ss.SSS} %-5level --- [%15.15(%thread)] %-40.40(%logger{40}) : %msg%n&lt;/pattern&gt;
            &lt;!-- 记录日志的编码:此处设置字符集 - --&gt;
            &lt;charset&gt;UTF-8&lt;/charset&gt;
        &lt;/encoder&gt;
    &lt;/appender&gt;
 
    &lt;!--给定记录器的每个启用的日志记录请求都将转发到该记录器中的所有appender以及层次结构中较高的appender（不用在意level值）。
    换句话说，appender是从记录器层次结构中附加地继承的。
    例如，如果将控制台appender添加到根记录器，则所有启用的日志记录请求将至少在控制台上打印。
    如果另外将文件追加器添加到记录器（例如L），则对L和L'子项启用的记录请求将打印在文件和控制台上。
    通过将记录器的additivity标志设置为false，可以覆盖此默认行为，以便不再添加appender累积--&gt;
    &lt;!-- configuration中最多允许一个root，别的logger如果没有设置级别则从父级别root继承 --&gt;
    &lt;root level=&quot;INFO&quot;&gt;
        &lt;appender-ref ref=&quot;STDOUT&quot; /&gt;
    &lt;/root&gt;
 
    &lt;!-- 指定项目中某个包，当有日志操作行为时的日志记录级别 --&gt;
    &lt;!-- 级别依次为【从高到低】：FATAL &gt; ERROR &gt; WARN &gt; INFO &gt; DEBUG &gt; TRACE  --&gt;
    &lt;logger name=&quot;com.sailing.springbootmybatis&quot; level=&quot;INFO&quot;&gt;
        &lt;appender-ref ref=&quot;info_log&quot; /&gt;
        &lt;appender-ref ref=&quot;error_log&quot; /&gt;
    &lt;/logger&gt;
 
    &lt;!-- 利用logback输入mybatis的sql日志，
    注意：如果不加 additivity=&quot;false&quot; 则此logger会将输出转发到自身以及祖先的logger中，就会出现日志文件中sql重复打印--&gt;
    &lt;logger name=&quot;com.sailing.springbootmybatis.mapper&quot; level=&quot;DEBUG&quot; additivity=&quot;false&quot;&gt;
        &lt;appender-ref ref=&quot;info_log&quot; /&gt;
        &lt;appender-ref ref=&quot;error_log&quot; /&gt;
    &lt;/logger&gt;
 
    &lt;!-- additivity=false代表禁止默认累计的行为，即com.atomikos中的日志只会记录到日志文件中，不会输出层次级别更高的任何appender--&gt;
    &lt;logger name=&quot;com.atomikos&quot; level=&quot;INFO&quot; additivity=&quot;false&quot;&gt;
        &lt;appender-ref ref=&quot;info_log&quot; /&gt;
        &lt;appender-ref ref=&quot;error_log&quot; /&gt;
    &lt;/logger&gt;
 
&lt;/configuration&gt;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br><span class="line-number">116</span><br><span class="line-number">117</span><br><span class="line-number">118</span><br><span class="line-number">119</span><br><span class="line-number">120</span><br><span class="line-number">121</span><br><span class="line-number">122</span><br><span class="line-number">123</span><br><span class="line-number">124</span><br><span class="line-number">125</span><br><span class="line-number">126</span><br><span class="line-number">127</span><br><span class="line-number">128</span><br><span class="line-number">129</span><br><span class="line-number">130</span><br><span class="line-number">131</span><br></div></div><h2 id="五、附加内容"><a href="#五、附加内容" class="header-anchor">#</a> 五、附加内容</h2> <p>错误 log 输出方式：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>Object entry = new SomeObject(); 
logger.debug(&quot;The entry is &quot; + entry);
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>上面看起来没什么问题，但是会存在构造消息参数的成本，即将 entry 转换成字符串相加。</p> <p>并且无论是否记录消息，都是如此，即：那怕日志级别为 INFO，也会执行括号里面的操作，但是日志不会输出。</p> <p>优化后的写法：首先对设置的日志级别进行了判断，如果为debug模式，才进行参数的构造，对第一种写法进行了改善。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>if(logger.isDebugEnabled()) { 
    Object entry = new SomeObject(); 
    logger.debug(&quot;The entry is &quot; + entry);
}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>不过还有最好的写法，使用占位符：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>Object entry = new SomeObject(); 
logger.debug(&quot;The entry is {}.&quot;, entry);
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>只有在评估是否记录之后，并且只有在决策是肯定的情况下，记录器实现才会格式化消息并将“{}”对替换为条目的字符串值。</p> <p>换句话说，当禁用日志语句时，此表单不会产生参数构造的成本。</p> <p><strong>logback 作者进行测试得出：第一种和第三种写法将产生完全相同的输出。<br>
但是，在禁用日志记录语句的情况下，第三个变体将比第一个变体优于至少30倍。</strong></p> <p>如果有多个参数，写法如下：</p> <blockquote><p>logger.debug(&quot;The new entry is {}. It replaces {}.&quot;, entry, oldEntry);</p></blockquote> <p>如果需要传递三个或更多参数，则还可以使用Object [] 变体：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>Object[] paramArray = {newVal, below, above};
logger.debug(&quot;Value {} was inserted between {} and {}.&quot;, paramArray); 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>记录日志的时候我们可能需要在文件中记录下异常的堆栈信息，经过测试，logger.error(e) 不会打印出堆栈信息，正确的写法是：</p> <blockquote><p>logger.error(&quot;程序异常, 详细信息:{}&quot;, e.getLocalizedMessage() , e);</p></blockquote> <p>原文地址：</p> <blockquote><p>white_ice - https://blog.csdn.net/white_ice/article/details/85065219</p></blockquote> <p><a href="https://github.com/rcbb-cc/fast-start-guide" target="_blank" rel="noopener noreferrer">logback-demo Github地址<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></div></div> <div class="page-slot page-slot-bottom"></br><ins class="adsbygoogle"
     style="display:block; text-align:center;"
     data-ad-layout="in-article"
     data-ad-format="auto"
     data-ad-client="ca-pub-8621788234752924"
     data-ad-slot="7043271566"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script></div> <div class="page-edit"><!----> <div class="tags"><a href="/tags/?tag=SpringBoot" title="标签">#SpringBoot</a><a href="/tags/?tag=logback" title="标签">#logback</a></div> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">10/18/2022</span></div></div> <div class="page-nav-wapper"><div class="page-nav-centre-wrap"><a href="/pages/412c27/" class="page-nav-centre page-nav-centre-prev"><div class="tooltip">Spring Security OAuth2自定义授权模式</div></a> <a href="/pages/f9c70c/" class="page-nav-centre page-nav-centre-next"><div class="tooltip">内网映射工具</div></a></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/pages/412c27/" class="prev">Spring Security OAuth2自定义授权模式</a></span> <span class="next"><a href="/pages/f9c70c/">内网映射工具</a>→
      </span></p></div></div></div> <div class="article-list"><div class="article-title"><a href="/archives/" class="iconfont icon-bi">最近更新</a></div> <div class="article-wrapper"><dl><dd>01</dd> <dt><a href="/pages/82530f/"><div>
            ChatGPT Plus订阅指南
            <!----></div></a> <span class="date">02-24</span></dt></dl><dl><dd>02</dd> <dt><a href="/pages/8b23f4/"><div>
            使用nvm控制node版本
            <!----></div></a> <span class="date">01-26</span></dt></dl><dl><dd>03</dd> <dt><a href="/pages/0e4b5e/"><div>
            git clone 报错：Filename too long
            <!----></div></a> <span class="date">01-26</span></dt></dl> <dl><dd></dd> <dt><a href="/archives/" class="more">更多文章&gt;</a></dt></dl></div></div></main></div> <div class="footer"><div class="icons"><a href="https://github.com/rcbb-cc" title="Star我" target="_blank" class="iconfont icon-github"></a><a href="https://music.163.com/playlist?id=5161366267" title="有品位的歌单" target="_blank" class="iconfont icon-erji"></a></div> 
  Theme by
  <a href="https://github.com/xugaoyi/vuepress-theme-vdoing" target="_blank" title="本站主题">Vdoing</a> 
    | Copyright © 2021-2024
    <span>日常bb | <a href="https://beian.miit.gov.cn/" target="_blank" style="font-weight:normal">鄂ICP备17023998号</a> </span></div> <div class="buttons"><div title="返回顶部" class="button blur go-to-top iconfont icon-fanhuidingbu" style="display:none;"></div> <div title="去评论" class="button blur go-to-comment iconfont icon-pinglun" style="display:none;"></div> <div title="主题模式" class="button blur theme-mode-but iconfont icon-zhuti"><ul class="select-box" style="display:none;"><li class="iconfont icon-zidong">
          跟随系统
        </li><li class="iconfont icon-rijianmoshi">
          浅色模式
        </li><li class="iconfont icon-yejianmoshi">
          深色模式
        </li><li class="iconfont icon-yuedu">
          阅读模式
        </li></ul></div></div> <!----> <!----> <!----></div><div class="global-ui"><!----><div></div></div></div>
    <script src="/assets/js/app.f183bd5e.js" defer></script><script src="/assets/js/2.ae7bab8c.js" defer></script><script src="/assets/js/31.18d6e525.js" defer></script>
  </body>
</html>
